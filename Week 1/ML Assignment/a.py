from collections import deque

def read_map():
    mars_map = [
        "...................................................................................................................................",
        "...##......#....#...#.....#.#....#...#...#...#......#........................##......#..#..#.#........#....................##......",
        "...#.......#..........#..#....#................#...##.....##...................#..........###......#.....#.........#....#.#........",
        "........#..##.............#..#...##...#..#...##...............................#.........................#..........................",
        "..............#............#..#..........#.#.#....#...#......................#..#......#.##...#............................#.......",
        "..##...............#...#...#......#.......................................#..............##...............#.....#...........#...#..",
        ".##............#.................#...#..#......#...................................#.......#.#..#......##................##........",
        "......###...#...#........#..............#....#.......##.......................##.......#..#.......#.........#...................#..",
        ".................#...........................................#......................#.....#.....##...........#...............#.....",
        "..#...#....#.......##...........#..#.............#............................##........#.......#...#...#...#....#....##...........",
        "..............#..#.....#.....#.........#..#..#..#..#.......#.#..#....##........#.....#.........#..............#........#..#...#....",
        "...##...............#...#.#....#............##..#.......................................#.......#...........#..#...........##....#.",
        ".......................................#......#...........#..........#.............#..........##.............#....#..##....#.......",
        "..................................#.............#........#...#.##.....................#....................#.##....#.............#.",
        ".#......##...#......#..#...#...........#...#.............#.............#..#.........#..#.#........#.#...........#..................",
        "............#............#..........#........#..........#.....#.#...#.......#........#.#...........#....#.............#.........#..",
        ".....#.......##............#...#.#.#...#...#..............##..#....#......#......................#...#...#..........#......#.#.....",
        "........#....#....#......#..........#........................#.....#....................................#.....#....#..##.##....#...",
        "............#.................#.##.........#.........#.....#........#.........#........#....###...........#.............#..........",
        "....##....#..#............#...#.#..#.........................#.#....##.....................#........#.........#....#....#........#.",
        "...#...#...........#..#..................#.......#.#..#............................................##................#.............",
        "...........#......#....#........#.#..........................#.#......#......##.............#..#...#...#.#..................#..#...",
        ".............................#........#............#........#........#.#.......#...............##....#........#...#..#..#..........",
        "..................................#...........................#.#..#.........................#...#.#......#..............##.....##.",
        "........................#..........................#..................#...#............................#.......#...........#...##..",
        ".......#.#.....#....#.....#................................##...#.........##..#.....................#..............................",
        "......#........##..........#.................#..##......#..#.......#..........#....................................................",
        "....#..........#......................................................##.#..#.#.##..................#......#............##...#.....",
        ".............#..........#.#..............................................#.#........#....#...........#.......................#.....",
        "..#.............#....#........#.#..............#.......#......#.#..#......#.#...........................................##.........",
        "..#.....#.....#....#...#....#..........#......#..............................#...........#............#..#.....##..........#.......",
        "......#.#.#...#........................#..........#.#......#............#......................................#...................",
        ".#...........#...#....................#..#..#....#.#........................................................................#.#....",
        "........#.#...........................#...#......#.#.#..#......##..#.#..#..#...#.#.#..................#.......##.#....#........#...",
        "......#......#......#.....#..............#.#.........##.................#....................#............#....##........#.........",
        "........#.............#..#............#......#........#....#............#.....#...........#..#...............###........#.....#....",
        ".....#.........##....#..................#..#...........#.#....##...........................#.............#..##..#.........#........",
        "............#....#..#.................#.............#..#.....##.....#.....#.........#........#............#........#.........##....",
        ".#.......#.#..........#...............#..............#.....#........#...#......#......##...........................#..#.#......##..",
        ".##.#.........#.............................#............................#.#..#...#.............#...#.........#...#......#.........",
        "................................#........#..#..........##......#..................................#................#.#...#...#.....",
        ".........#........#...........#........................#.#.##.........#.....#..#................................#.............##...",
        ".........#.#....#..#.........#.#....#.......#.............#........#............#...#..........#...##..........#........#........#.",
        "..............................###.....#......#......#...#....#...........#...#...............#.....##.#.....................#..#...",
        "..........................#......#...#..............................##.#.......#........##..........#................#...##.....#..",
        "...........#............................#..................#...#..#.....................#...#.................................#....",
        "..#.#...............................................#..........#..........#..............#............##...........................",
        "........#...#..................#.........#............#...............#.#..#.........#....#...............#.............##.........",
        "............................##....................##......#..#....#.......#....#........................#...#.........#.....#....#.",
        ".....#.#...............#....#..#....#...........#........#.#..................#.....##....#.......#......#......................#..",
        "...........#.........#.#.......#......#.#.#.......#.#...#...................#...#......#..............#...#....#.................#.",
        "...#..#...........#.............#..........##..............................###...........#.#.....##.......#.............#..........",
        "...##.....................##...#..#.....#.........#.#....#.#.....................#..............#.#...#...#......#..............#..",
        "......##................#.................#.#........#.#..#................#............#......#.#..............#...............#..",
        ".......#...........#.................................##..................#...#........#.......#..##...##...........#.........#.....",
        "..............#........#.............#..........#...............#..#.......#.........#..#...............#......#..#.........##.#...",
        ".....#..........................................#...............#....#......#..#................................#...............#..",
        "...............#.......#..#.........#......#..................#........#................#.#...........#....##......#............#..",
        "...........................#.....##.........#...#...........#........#..#................#.#.#............#..#...#.....#...........",
        "....................................#...........#..............#................#............#..#...............#.##..#.##.........",
        ".........#.#..............#........#.........#..#...#........#............##......##.......#....##.............#...................",
        "..........##.....................#................#...#....#........#.....#..........#........#................#..###..............",
        "......................#............................#........................#.#..#..........#......................................",
        "........#...........#.#....#.........#.....#..........#..#.#..............#.......................#..#................#.#..........",
        ".................................................................S.................................................................",
        ".........#.....#..#..........#.....#...........#...............##..#...............#.##....#...........#........#.#....#....#......",
        ".........##...#......#..#.#................#...........#..#...........#...#....#..............#......#..#.................##.......",
        ".....................##.....................##...#.......#......#.............................#..#.................................",
        "........................#..............#....#.................#....#...........#.................#...#.........#........#..........",
        ".........#..#.#...#.#..................#..............#.#...###....#......#......#.#....#..##..............#............#..........",
        "..#.......#...#..............#...#..##............#.........#......#.#....#.#..........................#......#..#.....#...........",
        "..#........#......##.............................#..............#..#....................##.......#....#..#..#..........#...........",
        ".....................#.....#...........#.##................#.#....#.#.#............#...#..##.............#.....##..................",
        "..##............#........#........#...#......#..........##.................#...#.#..........#...................................##.",
        "...#.............#....#...#..#........#.........#......#..................#..#..#..........#.....#........#.#....##............#...",
        "...#.............#...............................#.......#....#..........#..........................##......##...#.............#...",
        "....#................#..#.#................#.....#.......#..................#.......................#.#............................",
        "....#.#..............#..#.........#..#..#................#..#...#.#..............#......#...................#......................",
        ".#......#....................#.................#........##......#......##..........#...............#..##.#.....#.............#.....",
        "...##................#..........#......##.....#........#...#..................#........#......#....#..#.....#......................",
        "......#..................#......#.......#.......#..............#......#.........#.......#..#.#.#...##.....#.............#..........",
        ".#...................#...#....#......#.#.....#.....#..................#.#......#.......#.....#..#......................#.....#.....",
        "...#......................#.......#..#.........#............#...#......##..........#...............................................",
        "...#..#........#........#...........#.#...#...#.#..#.#...#..................#........#........#.#.##...#...........#...............",
        "........#.......................#.............#....#...##.........#....................................#..............#...#........",
        "...#...........##........#..#.......#...............................#..................#.....#.......#.#.........#.................",
        "..........#...............#.###...................#..................................#.....#...#................##...............#.",
        "..#......#..........................#...........................#..................#..#........#....##...................##......#.",
        "....#...........#..#..........................#......###................#...........................#.........#.#........#.#.......",
        "...#...#..#........#...............#...........#.......#........................##..#...............#............#...........#.....",
        ".....#..........................#..#........#.......#......#......#..........#..#.....#.....#..#.................#........#........",
        "....#...##.......................#...#.....#.....................................##.#..#....#....#................#................",
        "..#.....##.........#..............#.#................#.........#...#.................#.........#..............................#....",
        "............#...........#........#........................#.#.......#..#..#.........##...................#......##.#.......#.......",
        ".........#......#......#............#.....#...##...#...............................#.....#..............##............#..#.....##..",
        "...........................#.................#...........#.........#....#.#.#....#......#..#....................#......#...........",
        "....#.#..............................#......#..........#...........#....#.............#.#..............................#.....#..#..",
        "...........#...........#.............##....#......#.........#................#........#...............................#............",
        "...#........#.#....#.....................#..........#.......#...#.........#..........................##........#.#.#...##..........",
        "....#.#....#.........#.......#....................#...........#..........#....#......................#.............#.....#..#....#.",
        "..........#................................#......#....#......#.................................................#..................",
        ".............#................................#...#.##.#.....#.......#....#............###.......#........##.......................",
        "..........#......##.............#.........#............................#.#..#.......................................#.....#......#.",
        "...#.....#.......#............#.............#.#...#.....#.............#..#..........##.......................#.....................",
        "..........................#......#..................#..#........#............#.......##......................###.......#.....#.....",
        "............#.#....#.#................................##......#..............#..#.#........................#......#...#...#........",
        "......##..........#......###...#......................#.........#.#............#..............#......#..............#.......#......",
        "............#........#.....#........#..#.......#...#...................#.....#..................##.............#.................#.",
        "........#.#........##..................................#......#......................................#.....................#.#...#.",
        ".#.......##......#.....#..........#................#...................##..#...............#.......##....................#.........",
        "...#..#..#.............................#...................#................#....................................#........#........",
        ".....#....................................#.........##.............#...........................#...................................",
        "............................#....#......#...................#..................................#...........................##......",
        "...............#...#..#...#.###.#...........#..............#..........#...............##........#.##.#....#.#.............##.....#.",
        "...........#.##......#...#.#.........#.#.#...#.........................................#..........#.............#.#.............#..",
        "........#...............#........#........................#.#......#......#......................#...........#.........#.#...#.....",
        "....#..#.............#......................#...................#.....##...............#...#........#.................#............",
        "............#......#...#.....#..........#....#...............##.....##..#.........#....#..#.......#...#..#.........................",
        "......#...........#.......#...#.#.....#...#......#...........#......#................#................#....#.#...#.................",
        ".......#.#...#.......#......#.................................#..............................#...........#.............#.........#.",
        "...................................#.....#.........#.............................#..#............#...................#...#.........",
        "...............#......#...........................#................#...............##...........#......#........#....##......#.#...",
        "...............#....................##....#...#.....#.................................#..#.............#.#..#.....#..#.#...........",
        ".............................#......##..#........................................##....#.................#......#....#...#.........",
        "......#.#.#...............#.......#............................................................#................#..........#..#....",
        "...#.#...........#..#......#....###...............#..#..#......................#....#..............#......#................#.......",
        ".......................#....#.....#..#.##.#..........#.....................#..................................#....####.##.........",
        "......#..........##...#...........................#....#.................#........#.......................#.................#..#...",
        ".................#..#...................#..#...#...##...#..................#..........#.#....#..#...........................#....#.",
        ".......................................................................................................",
    ]
    return mars_map

def find_start_position(mars_map):
    for i, row in enumerate(mars_map):
        for j, cell in enumerate(row):
            if cell == 'S':
                return i, j
    return None, None

def is_within_bounds(x, y, rows, cols):
    return 0 <= x < rows and 0 <= y < cols

def bfs(mars_map, start, steps):
    rows, cols = len(mars_map), len(mars_map[0])
    directions = [(-1, 0), (1, 0), (0, -1), (0, 1)]  # Up, Down, Left, Right
    
    queue = deque([(start, 0)])
    visited = set()
    visited.add(start)
    
    while queue:
        (current_x, current_y), current_steps = queue.popleft()
        
        if current_steps == steps:
            continue
        
        for direction